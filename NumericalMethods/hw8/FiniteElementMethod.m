% finite element method
r = [0,0.25,0.5,0.75,1];
A = [8   -4  0;
     -4   8  -4;
     0   -4  8;];
B = [1/24  1/64  0;
     1/64  1/12  5/192;
     0     5/192 1/8;];
b = [-0.25;-0.25;-0.25];
% solve Aa + Ba = b
a = (A+B)\b

% plot
x = 0:0.01:1;
ux = [a(1).*phi(0,0.25,0.5,x)+ a(2).*phi(0.25,0.5,0.75,x)+ a(3).*phi(0.5,0.75,1, x)];
plot(x,ux)